{
    "app-id": "com.Acestream.engine",
    "runtime": "org.gnome.Platform",
    "runtime-version": "3.36",
    "sdk": "org.gnome.Sdk",
    "command": "acestream",
    "tags": [
        "proprietary"
    ],
    "finish-args": [
        "--share=ipc",
        "--socket=x11",
        "--socket=pulseaudio",
        "--share=network",
        "--device=dri",
        "--filesystem=home"
    ],
    "modules": [
            "shared-modules/gtk2/gtk2.json",
            "shared-modules/python2.7/python-2.7.json",
            "shared-modules/dbus-glib/dbus-glib-0.110.json",
        {
            "name": "pango",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/pango/1.38/pango-1.38.1.tar.xz",
                    "sha256": "1320569f6c6d75d6b66172b2d28e59c56ee864ee9df202b76799c4506a214eb7"
                }
            ]
        },       
        {
            "name": "apsw",
            "buildsystem": "simple",
            "build-commands": [
                "touch .separate_namespace",
                "python setup.py install --prefix=/app"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://files.pythonhosted.org/packages/b5/a1/3de5a2d35fc34939672f4e1bd7d68cca359a31b76926f00d95f434c63aaa/apsw-3.9.2-r1.tar.gz",
                    "sha256": "dab96fd164dde9e59f7f27228291498217fa0e74048e2c08c7059d7e39589270"
                }
            ]
        },
        {
            "name": "pygtk",
            "config-opts": ["--disable-docs"],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/pygtk/2.24/pygtk-2.24.0.tar.gz",
                    "sha256": "6e3e54fa6e65a69ac60bd58cb2e60a57f3346ac52efe995f3d10b6c38c972fd8"
                },
                {
                    "type": "shell",
                    "commands": [
                        "cp -p /usr/share/automake-*/config.{sub,guess} ."
                    ]
                }
            ],
            "modules": [
                {
                    "name": "python2-pycairo",
                    "buildsystem": "meson",
                    "config-opts": ["-Dpython=python2"],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/pygobject/pycairo/releases/download/v1.18.1/pycairo-1.18.1.tar.gz",
                            "sha256": "70172e58b6bad7572a3518c26729b074acdde15e6fee6cbab6d3528ad552b786"
                        }
                    ]
                },
                {
                    "name": "pygobject",
                    "config-opts": ["--disable-glibtest"],
                    "cleanup": ["/bin"],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://download.gnome.org/sources/pygobject/2.28/pygobject-2.28.7.tar.xz",
                            "sha256": "bb9d25a3442ca7511385a7c01b057492095c263784ef31231ffe589d83a96a5a"
                        }
                    ]
                }
            ]
        },
            "libs/libappindicator/libappindicator-gtk2-12.10.json",   
         {
            "name": "acestream",
            "buildsystem": "simple",
            "build-commands": [
                "install -Dm755 apply_extra /app/bin/apply_extra",
                "install -Dm755 acestream.sh /app/bin/acestream",
                "for size in 16 24 32 48 64 128 256; do\n                    rsvg-convert -w $size -h $size -f png -o $size.png logo-small.svg\n                    install -Dm644 $size.png /app/share/icons/hicolor/${size}x${size}/apps/com.Acestream.engine.png\n                done",
                "install -Dm644 logo-small.svg export/share/icons/hicolor/scalable/apps/com.Acestream.engine.svg",
                "install -Dm644 com.Acestream.engine.appdata.xml /app/share/appdata/com.Acestream.engine.appdata.xml",
                "install -Dm644 com.Acestream.engine.desktop /app/share/applications/com.Acestream.engine.desktop"
            ],
            "sources": [
                {
                    "type": "script",
                    "dest-filename": "apply_extra",
                    "commands": [
                        "tar -zxvf acestream.tar.gz",
                        "rm -f acestream.tar.gz"
                    ]
                },
               {
                    "type": "script",
                    "dest-filename": "acestream.sh",
                    "commands": [
                        "exec /app/extra/start-engine --client-gtk --log-file $XDG_DATA_HOME/acestream.log \"$@\""
                    ]
                },                                                                            
                {
                    "type": "extra-data",
                    "filename": "acestream.tar.gz",
                    "only-arches": [
                        "x86_64"
                    ],
                    "url": "https://drive.google.com/uc?id=1hIWE_hrxnmBiQWNRJYTAKJCgtI0lwdcr&export=download",
                    "sha256": "d2ed7bdc38f6a47c05da730f7f6f600d48385a7455d922a2688f7112202ee19e",
                    "size": 17001150,                    
                    "x-checker-data": {
                        "type": "html",
                        "url": "http://download.acestream.media/linux/",
                        "url-pattern": "(http://download.acestream.media/linux/acestream_[0-9.]+_ubuntu_[0-9.]+_x86_64.tar.gz)",
                        "version-pattern": "http://download.acestream.media/linux/acestream_[0-9.])+_ubuntu_[0-9.]+_x86_64.tar.gz"
                    }                     
                },
                {
                    "type": "file",
                    "path": "com.Acestream.engine.desktop"
                },
                {
                    "type": "file",
                    "path": "com.Acestream.engine.appdata.xml"
                },
                {
                    "type": "file",
                    "path": "logo-small.svg"
                }                                          
            ]
        }
    ]
}
